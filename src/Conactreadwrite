import React, { useState } from 'react';


const ContactUs = () => {
    const [formData, setFormData] = useState({});
    const [message, setMessage] = useState("");

    const handleInput = e => {
        const copyFormData = { ...formData };
        copyFormData[e.target.name] = e.target.value;
        setFormData(copyFormData);
    };

    const sendData = async e => {
        e.preventDefault();

        try {

            const response = await fetch(
                "https://v1.nocodeapi.com/contactdemo/google_sheets/wTjFgOoinbtcujFc?tabId=Sheet1",
                {
                    method: "post",
                    body: JSON.stringify([
                        [formData.name, formData.email, formData.subject, formData.message]
                    ]),
                    headers: {
                        "Content-Type": "application/json"
                    }
                }
            );
            const json = await response.json();
            console.log("Success:", JSON.stringify(json));
            setMessage("Thank you for contacting us");
        } catch (error) {
            setMessage("Error");            

        }
    };
    async function getData() {
        
           
            var request = require('request');
            var options = {
                'method': 'GET',
                'url': "https://v1.nocodeapi.com/contactdemo/google_sheets/wTjFgOoinbtcujFc?tabId=Sheet1",
                  'headers': {
             },
             "includeGridData": true,
             "ranges": [
                "Sheet1"
              ]
        };
        request(options, function (error, response) {
                  if (error) throw new Error(error);
                      console.log(response.body);
            });
    
        }
    return (
        <div >

            <form className="m-auto col-9 border border-light p-5" onSubmit={sendData}> 
            <form className="m-auto col-9 border border-light p-5" onClick={getData()}></form>
                <h1 className="h4 mb-4">Contact us</h1>

                <label>Name</label>
                <input type="text" name="name" className="form-control mb-4" placeholder="Name" onChange={handleInput} required></input>

                <label>Email</label>
                <input type="email" name="email" className="form-control mb-4" placeholder="E-mail" onChange={handleInput} required ></input>


                <label>Subject</label>
                <input type="text" name="subject" className="form-control mb-4" placeholder="Subject" onChange={handleInput} required></input>

                <label>Your Message</label>
                <div className="form-group">
                    <textarea className="form-control rounded-0" name="message" type="text" placeholder="Message" onChange={handleInput} required></textarea>
                </div>


                <div className="custom-control custom-checkbox mb-4">
                    <input type="checkbox" className="custom-control-input" id="FormCopy"></input>
                    <label className="custom-control-label" htmlFor="FormCopy">Send me a copy of this message</label>
                </div>


                <button className="btn btn-info btn-block" name="submit" type="submit">Send</button>
                <button className="btn btn-info btn-block" onclick="getData()">Get</button>
             
                <div>{message}</div>
            </form>
           
        </div>


    )
}


export default ContactUs;
